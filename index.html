<!DOCTYPE html>

<html>
<head>
    <title>CS 3300 Project 1</title>
    <meta charset="utf-8">
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="//d3js.org/topojson.v2.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
    <link type="text/css" rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css?family=Karla|Space+Mono" rel="stylesheet">
</head>

<body>
    <div id="sidebar">
        <p> This is the sidebar!</p>
    </div>
    <div id = "content">
    <h1> UFOs: Unsubstantiated False Observations</h1>
    <h2> by Tayyaba Arshad, Chris Huber, Shiva Lakshmanan</h2>
    <a href="map_draft.html"> Visualization 2</a>
    <p>This is a test.This is a test.This is a test.This is a test.This is a test.This is a test.This is a test.This is a test.This is a test.This is a test.This is a test.This is a test. </p>
    <svg id="hist_svg" width="700" height="450">
        
    </svg>
        
    <!--Tron    Orange: #DF740C,TronYellow: #FFE64D,White: #E6FFFF,TronBlue: #6FC3DF,black: #0C141F,-->
    <script>
    var svg = d3.select("#hist_svg");
    var UFOdata;
    var bins;
    var x = d3.scaleTime()
    .domain([1970, 2017])
    .range([0,470]);
    
    
    var y = d3.scaleLinear()
    .domain([0,7357])
    .range([0,360]);
    
    var histogram = d3.histogram()
    .value(function(d) { return d.datetime; })
    .domain(x.domain())
    .thresholds(x.ticks(47));
    
    var xScale = d3.scaleLinear()
    .domain([1970,2016])
    .range([0,470]);
        
    var yScale = d3.scaleLinear()
    .domain([48238800,287885038])
    .range([360,0]);
    
    var yScale_for_axis = d3.scaleLinear()
    .domain([0,7357])
    .range([360,0]);
    
    var yAxisLeft = d3.axisLeft(yScale)
    .ticks(7);
    
    svg.append("g")
      .style("opacity", 0.65)
      .attr("stroke", "red")
      .call(yAxisLeft);
    
    d3.csv("scrubbed.csv", function(error, data) {
        if (error) throw error;
        data.forEach(function (d) {
            var date = d.datetime.split("/");
            date = d.datetime.split("/")[2]; //date with year and military time
            date = Number(date.substring(0,4)); //extract year
            d.datetime = date;
        });
    function filterFunction(d) {return d.datetime >= 1970;}
    var newData = data.filter(filterFunction);
    UFOdata = newData;
    bins = histogram(UFOdata);
        
    var barColor = "#6FC3DF";
    var lineColor = "#DF740C";
    var barOpacity = .7;
    
    
    bins.forEach(function (d,i) {
        svg.append("rect")
        .attr("x", 10*i)
        .attr("y", 360-y(d.length)+4)
        .attr("width", 10)
        .attr("height", y(d.length))
        .style("opacity", barOpacity)
        .style("stroke", "black")
        .attr("fill", barColor);
        svg.append("text")
        .attr("x", 5+(10*i))
        .attr("y", 360-y(d.length))
        .style("text-anchor", "middle")
        .style("alignment-baseline", "central")
        .text(d.length)
        .attr("font-size", 6);
    });
    for (var i = 0; i < 5; i++) {
    svg.append("text")
    .attr("x", 5+(100*i))
    .attr("y", 378)
    .style("text-anchor", "middle")
    .style("alignment-baseline", "central")
    .text(1970+(10*i))
    .attr("font-size", 9);
    svg.append("line")
    .attr("x1", 5+(100*i))
    .attr("y1", 365)
    .attr("x2", 5+(100*i))
    .attr("y2", 370)
    .attr("stroke", "black")
    .attr("stroke-width", 2);
    }
    svg.append("line")
    .attr("x1", 0)
    .attr("y1", 365)
    .attr("x2", 480)
    .attr("y2", 365)
    .attr("stroke", "black")
    .attr("stroke-width", 1.5);
    
    svg.append("rect")
    .attr("x", 0)
    .attr("y", 0)
    .attr("width", 40)
    .attr("height", 20)
    .attr("fill", barColor)
    .attr("stroke", "grey")
    .style("opacity", barOpacity);
    
    svg.append("text")
    .attr("id", "histogram_title")
    .attr("x", 80)
    .attr("y", 10)
    .style("text-anchor", "middle")
    .style("alignment-baseline", "central")
    .text("# of UFO Sightings")
    .attr("font-size", 7);
    
    svg.append("text")
    .attr("id", "histogram_title")
    .attr("x", 80)
    .attr("y", 17)
    .style("text-anchor", "middle")
    .style("alignment-baseline", "central")
    .text("Per Year")
    .attr("font-size", 7);
    
    svg.append("line")
    .attr("x1", 0)
    .attr("y1", 30)
    .attr("x2", 40)
    .attr("y2", 30)
    .attr("stroke", lineColor)
    .style("opacity", 0.7);
    
    svg.append("text")
    .attr("id", "linegraph_title")
    .attr("x", 80)
    .attr("y", 30)
    .style("text-anchor", "middle")
    .style("alignment-baseline", "central")
    .text("# of Plane Departures")
    .attr("font-size", 7);
    
    svg.append("text")
    .attr("id", "linegraph_title")
    .attr("x", 80)
    .attr("y", 37)
    .style("text-anchor", "middle")
    .style("alignment-baseline", "central")
    .text("Per Year")
    .attr("font-size", 7);
    
    var everything = d3.selectAll("svg > *");
    everything.attr("transform", "translate(100,20)");
    
    var histogram_title = d3.select("#histogram_title");
    
    svg.append("g")
    .attr("stroke", "blue")
    .style("opacity", 0.65)
    .attr("transform", "translate(580,25)")
    .call(d3.axisRight(yScale_for_axis));
    
    svg.append("text")
    .text("UFO sightings vs Planes in the air")
    .attr("x", 240)
    .attr("y", 50)
    .attr("font-size", 15);
    
    });
        
    var flightsData;
    
    d3.csv("flights_by_year.csv", function(error, data) {
        if (error) throw error;
        
        var lineColor = "#DF740C";

        flightsData = data;
        data.forEach(function (d,i) {
            if (i+1 != flightsData.length) {
            svg.append("line")
            .attr("x1", xScale(d.Year))
            .attr("y1", yScale(d.totalFlights))
            .attr("x2", xScale(data[i+1].Year))
            .attr("y2", yScale(data[i+1].totalFlights))
            .attr("stroke", lineColor)
            .style("opacity", 1.0)
            .attr("stroke-width", 3);
                
            }
        });
    });
    

    </script>
    </div><!--eND OF CONTENT DIV-->
</body>
</html>
